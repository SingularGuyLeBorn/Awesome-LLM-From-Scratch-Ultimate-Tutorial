run_name: grpo-deepseek-v3_nano-{timestamp}
output_dir: ./runs/
device: cpu
console:
  verbose: true
data:
  tokenizer_name: ./data_pipeline/processed_data/tinystories_project_vs4096.json
  prompt_data_path: ./data_pipeline/prompts/h4_prompts.txt
model:
  dim: 64
  n_layers: 2
  n_heads: 4
  n_kv_heads: 4
  vocab_size: 4096
  multiple_of: 16
  norm_eps: 1.0e-05
  max_seq_len: 128
  dropout: 0.0
  attention_variant: mla
  q_lora_rank: 16
  kv_lora_rank: 16
  v_head_dim: 16
  rope_head_dim: 8
  nope_head_dim: 8
  num_experts: 4
  num_shared_experts: 1
  num_experts_per_tok: 2
  use_aux_free_lb: true
  use_activation_checkpointing: true
rl:
  algorithm: grpo
  sft_model_checkpoint: will_be_overridden
  reward_model_checkpoint: will_be_overridden
  kl_coeff: 0.04
  group_size: 4
  max_prompt_len: 32
  max_gen_len: 64
  generate:
    temperature: 0.7
    top_k: 20
  rollout_batches: 2
  update_epochs: 1
  update_batch_size: 4
  clip_epsilon: 0.2
training:
  batch_size: 1
  gradient_accumulation_steps: 4
  max_epochs: 1
  weight_decay: 0.0
  clip_grad_norm: 1.0
  loss_spike_threshold: 10.0
  use_activation_checkpointing: true
  learning_rate: 5.0e-07
